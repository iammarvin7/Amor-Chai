(()=>{var e={};e.id=607,e.ids=[607],e.modules={399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},1282:e=>{"use strict";e.exports=require("child_process")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2615:e=>{"use strict";e.exports=require("http")},5240:e=>{"use strict";e.exports=require("https")},1764:e=>{"use strict";e.exports=require("util")},7794:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>y,routeModule:()=>p,serverHooks:()=>d,workAsyncStorage:()=>h,workUnitAsyncStorage:()=>l});var s={};r.r(s),r.d(s,{POST:()=>c});var n=r(2412),o=r(4293),i=r(4147),a=r(2895);function u(e){return e*Math.PI/180}async function c(e){try{let{items:t,location:r,successUrl:s,cancelUrl:n}=await e.json();if(!Array.isArray(t)||0===t.length)return new Response(JSON.stringify({error:"Cart is empty."}),{status:400});if(!process.env.STRIPE_SECRET_KEY)return new Response(JSON.stringify({error:"Stripe is not configured. Please set STRIPE_SECRET_KEY in .env"}),{status:500});if(!(r&&"number"==typeof r.lat&&"number"==typeof r.lng&&10>=function(e,t,r,s){let n=u(r-37.3059),o=u(s- -89.5181),i=Math.sin(n/2)*Math.sin(n/2)+Math.cos(u(37.3059))*Math.cos(u(r))*Math.sin(o/2)*Math.sin(o/2);return 2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i))*3958.761}(0,0,r.lat,r.lng)))return new Response(JSON.stringify({outsideZone:!0,message:"you are outside the delivery zone, if you still want the product, i suggest you contact us on instagram"}),{status:403});let o=new a.Z(process.env.STRIPE_SECRET_KEY,{apiVersion:"2024-06-20"}),i=t.map(e=>{let t=Math.round((e?.price??0)*100);return!t||t<=0?null:{price_data:{currency:"usd",product_data:{name:e?.name||"Item",images:e?.image?[e.image]:void 0},unit_amount:t},quantity:e?.qty&&e.qty>0?e.qty:1}}).filter(Boolean);if(!i.length)return new Response(JSON.stringify({error:"No valid items."}),{status:400});let c=e.headers.get("origin")||process.env.NEXT_PUBLIC_SITE_URL||"http://localhost:3000",p=await o.checkout.sessions.create({mode:"payment",payment_method_types:["card"],line_items:i,success_url:"string"==typeof s&&s.startsWith("http")?s:`${c}/?checkout=success`,cancel_url:"string"==typeof n&&n.startsWith("http")?n:`${c}/?checkout=cancel`});return Response.json({url:p.url})}catch(e){return console.error("Checkout error:",e),new Response(JSON.stringify({error:"Internal server error"}),{status:500})}}let p=new n.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/checkout/route",pathname:"/api/checkout",filename:"route",bundlePath:"app/api/checkout/route"},resolvedPagePath:"/Users/marvinchaudhary/Desktop/Codes/REACT/Amor_Chai_website/amor-chai-website/app/api/checkout/route.js",nextConfigOutput:"",userland:s}),{workAsyncStorage:h,workUnitAsyncStorage:l,serverHooks:d}=p;function y(){return(0,i.patchFetch)({workAsyncStorage:h,workUnitAsyncStorage:l})}},5303:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[147,886],()=>r(7794));module.exports=s})();