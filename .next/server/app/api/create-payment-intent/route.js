(()=>{var e={};e.id=70,e.ids=[70],e.modules={399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},1282:e=>{"use strict";e.exports=require("child_process")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2615:e=>{"use strict";e.exports=require("http")},5240:e=>{"use strict";e.exports=require("https")},1764:e=>{"use strict";e.exports=require("util")},4287:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>x,routeModule:()=>d,serverHooks:()=>m,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>h});var s={};r.r(s),r.d(s,{POST:()=>c});var n=r(2412),a=r(4293),o=r(4147),i=r(7856);let u=new(r(2895)).Z(process.env.STRIPE_SECRET_KEY);function p(e){return e*Math.PI/180}async function c(e){try{let{items:t,location:r}=await e.json();if(!t||0===t.length)return i.NextResponse.json({error:"Cart is empty."},{status:400});if(r&&"number"==typeof r.lat&&"number"==typeof r.lng&&!(10>=function(e,t,r,s){let n=p(r-37.3059),a=p(s- -89.5181),o=Math.sin(n/2)*Math.sin(n/2)+Math.cos(p(37.3059))*Math.cos(p(r))*Math.sin(a/2)*Math.sin(a/2);return 2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))*3958.761}(0,0,r.lat,r.lng)))return i.NextResponse.json({error:"You are outside the delivery zone. Please contact us on Instagram to arrange delivery.",outsideZone:!0},{status:403});let s=t.reduce((e,t)=>e+(t.price||0)*(t.qty||1),0),n=s+.08*s;if(n<=0)return i.NextResponse.json({error:"Invalid cart total."},{status:400});let a=await u.paymentIntents.create({amount:Math.round(100*n),currency:"usd",automatic_payment_methods:{enabled:!0}});return i.NextResponse.json({clientSecret:a.client_secret})}catch(e){return console.error("API Error creating payment intent:",e),i.NextResponse.json({error:"An unexpected error occurred."},{status:500})}}let d=new n.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/create-payment-intent/route",pathname:"/api/create-payment-intent",filename:"route",bundlePath:"app/api/create-payment-intent/route"},resolvedPagePath:"/Users/marvinchaudhary/Desktop/Codes/REACT/Amor_Chai_website/amor-chai-website/app/api/create-payment-intent/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:l,workUnitAsyncStorage:h,serverHooks:m}=d;function x(){return(0,o.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:h})}},5303:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[147,886,856],()=>r(4287));module.exports=s})();